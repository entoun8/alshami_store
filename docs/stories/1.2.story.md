# Story 1.2: Home Page Redirect to Products

## Status

Done

## Story

**As a** customer,
**I want** to land directly on the products page when visiting the store,
**so that** I can start shopping immediately without extra clicks.

## Acceptance Criteria

| #   | Criteria                                                         |
| --- | ---------------------------------------------------------------- |
| AC1 | Visiting `/` redirects to `/products` (HTTP 307 or 308 redirect) |
| AC2 | The hero/banner landing page content is removed or archived      |
| AC3 | About and Contact pages remain accessible from header navigation |
| AC4 | SEO metadata is updated appropriately                            |
| AC5 | Any internal links pointing to `/` are updated if needed         |

## Tasks / Subtasks

- [x] **Task 1: Implement redirect from `/` to `/products`** (AC: 1)
  - [x] 1.1 Modify `app/(root)/page.tsx` to use Next.js `permanentRedirect()` function
  - [x] 1.2 Import `permanentRedirect` from `next/navigation`
  - [x] 1.3 Call `permanentRedirect('/products')` at the top of the component
  - [x] 1.4 Use permanent redirect (308) via `next.config.ts` redirects config

- [x] **Task 2: Archive/remove hero page content** (AC: 2)
  - [x] 2.1 Remove the hero section JSX from `app/(root)/page.tsx`
  - [x] 2.2 Remove unused imports (Button, ArrowRight, ShoppingBag, Link, Image, heroBackground)
  - [x] 2.3 Hero content deleted (not archived)

- [x] **Task 3: Verify header navigation** (AC: 3)
  - [x] 3.1 Confirm `navLinks` in Header.tsx includes Products, About, and Contact
  - [x] 3.2 Test that clicking About navigates to `/about`
  - [x] 3.3 Test that clicking Contact navigates to `/contact`

- [x] **Task 4: Update Logo component link** (AC: 5)
  - [x] 4.1 Modify `components/layout/Logo.tsx` to link to `/products` instead of `/`
  - [x] 4.2 This ensures logo click takes user to products (the new "home")

- [x] **Task 5: Update SEO metadata** (AC: 4)
  - [x] 5.1 Review if `/products` page has appropriate metadata (title, description)
  - [x] 5.2 Since redirect is permanent (308), search engines will treat `/products` as the canonical home
  - [x] 5.3 No additional changes needed to `app/layout.tsx` metadata (already uses APP_NAME and APP_DESCRIPTION)

- [x] **Task 6: Verify footer links** (AC: 3, 5)
  - [x] 6.1 Confirm Footer.tsx links point to correct paths (already using `/products`, `/contact`, `/about`)
  - [x] 6.2 No changes needed - no link pointed to `/`

- [x] **Task 7: Manual Integration Verification Testing**
  - [x] 7.1 Visit `/` and confirm redirect to `/products` (IV1) - 308 redirect confirmed
  - [x] 7.2 Test all header navigation links work (IV1) - all return 200 OK
  - [x] 7.3 Test all footer navigation links work (IV2) - verified in code
  - [x] 7.4 Test logo click navigates to `/products` (IV3) - updated to /products

## Dev Notes

### Previous Story Insights

[Source: docs/stories/1.1.story.md#dev-agent-record]

Story 1.1 was a database-only story (RLS policies). No relevant code patterns or technical decisions carry over to this UI story.

### Implementation Approach

[Source: architecture/7-source-tree.md#modified-files-summary]

This is a simple redirect story with minimal code changes:

| File                         | Modification                             |
| ---------------------------- | ---------------------------------------- |
| `app/(root)/page.tsx`        | Replace hero content with redirect       |
| `components/layout/Logo.tsx` | Update link href from `/` to `/products` |

### Next.js Redirect Pattern

[Source: Next.js App Router documentation - redirect function]

```tsx
// app/(root)/page.tsx - FINAL IMPLEMENTATION
import { redirect } from "next/navigation";

export default function HomePage() {
  redirect("/products");
}
```

**Important Notes:**

- `redirect()` throws a `NEXT_REDIRECT` error internally, so it should be called outside of try/catch blocks
- For permanent redirects (308), use `redirect('/products', RedirectType.permanent)` or configure in `next.config.js`
- The default `redirect()` uses 307 (temporary) - for SEO, 308 (permanent) is preferred

**Alternative using next.config.js:**

```js
// next.config.js - alternative approach
module.exports = {
  async redirects() {
    return [
      {
        source: "/",
        destination: "/products",
        permanent: true, // 308 redirect
      },
    ];
  },
};
```

**Recommendation:** Use the `next.config.js` approach for permanent redirects as it's more explicit and SEO-friendly. However, the in-component `redirect()` is also valid.

### File Locations

[Source: architecture/7-source-tree.md#existing-project-structure]

| File             | Path                                       |
| ---------------- | ------------------------------------------ |
| Home page        | `app/(root)/page.tsx`                      |
| Logo component   | `components/layout/Logo.tsx`               |
| Header component | `components/layout/root_layout/Header.tsx` |
| Footer component | `components/layout/root_layout/Footer.tsx` |
| Products page    | `app/(root)/products/page.tsx`             |

### Current Home Page Analysis

[Source: app/(root)/page.tsx - current file]

Current home page contains:

- Hero section with background image (`/public/images/hero_img.jpg`)
- Overlay with centered content
- "Discover Premium Herbs & Coffee" heading
- Description paragraph
- Two CTAs: "Shop Now" → `/products`, "Learn More" → `/about`

After this story, the entire hero section will be removed and replaced with a redirect.

### Internal Links to Update

[Source: Code review of Logo.tsx]

| Component                    | Current Link | New Link           | Reason                                            |
| ---------------------------- | ------------ | ------------------ | ------------------------------------------------- |
| `components/layout/Logo.tsx` | `href="/"`   | `href="/products"` | Logo should navigate to the new "home" (products) |

**Footer Analysis:** Footer.tsx does NOT link to `/` - it only links to `/products`, `/contact`, `/about`, `/faq`. No changes needed.

**Header Analysis:** Header navLinks array uses `/products`, `/about`, `/contact`. No links to `/`. No changes needed.

### SEO Considerations

[Source: architecture/7-source-tree.md#route-structure-after-enhancement]

After this story:

- `/` becomes a redirect (308 permanent)
- `/products` becomes the canonical home page
- Search engines will index `/products` as the primary landing page
- Existing metadata from `app/layout.tsx` will apply (APP_NAME, APP_DESCRIPTION)

### Coding Standards Compliance

[Source: architecture/9-coding-standards.md]

- No new UI components needed (shadcn/ui not required for this story)
- No color classes used (redirect only)
- No layout changes (`.wrapper` class not applicable)
- Simple Server Component pattern with redirect

### Testing

[Source: architecture/10-testing-strategy.md#story-12-home-redirect-test-cases]

**Manual Test Cases:**

| #       | Test Case                  | Steps                    | Expected Result           |
| ------- | -------------------------- | ------------------------ | ------------------------- |
| REDIR-1 | Root redirects to products | Visit `/`                | Redirected to `/products` |
| REDIR-2 | Navigation still works     | Click logo, header links | All navigation functional |

**Integration Verification:**

| #   | Verification                       |
| --- | ---------------------------------- |
| IV1 | Header navigation still works      |
| IV2 | Footer links still work            |
| IV3 | Logo click behavior is appropriate |

**Testing Framework:** Manual testing (no automated test framework established)

---

## Change Log

| Date       | Version | Description               | Author            |
| ---------- | ------- | ------------------------- | ----------------- |
| 2026-01-18 | 1.0     | Initial story draft       | SM Agent (Bob)    |
| 2026-01-18 | 1.1     | Implementation complete   | Dev Agent (James) |
| 2026-01-18 | 1.2     | QA fix: LINK-001 resolved | Dev Agent (James) |

---

## Dev Agent Record

### Agent Model Used

Claude Opus 4.5 (claude-opus-4-5-20251101)

### Debug Log References

None - no debug issues encountered.

### Completion Notes List

- Used `next.config.ts` `redirects()` for 308 permanent redirect (SEO-friendly)
- Kept `permanentRedirect()` in page.tsx as fallback defense-in-depth
- Also updated `app/not-found.tsx` "Go Home" link from `/` to `/products` (discovered during lint check)
- Fixed pre-existing lint error in not-found.tsx (unescaped apostrophes)
- **QA Fix (LINK-001):** Updated "Continue Shopping" link in stripe-payment-success page from `/` to `/products`

### File List

| File                                                    | Action   | Description                                                       |
| ------------------------------------------------------- | -------- | ----------------------------------------------------------------- |
| `app/(root)/page.tsx`                                   | Modified | Replaced hero content with permanentRedirect()                    |
| `components/layout/Logo.tsx`                            | Modified | Changed href from `/` to `/products`                              |
| `next.config.ts`                                        | Modified | Added redirects() config for 308 permanent redirect               |
| `app/not-found.tsx`                                     | Modified | Updated "Go Home" link to `/products`, fixed lint errors          |
| `app/(root)/order/[id]/stripe-payment-success/page.tsx` | Modified | Updated "Continue Shopping" href from `/` to `/products` (QA fix) |

---

## QA Results

### Review Date: 2026-01-18

### Reviewed By: Quinn (Test Architect)

### Risk Assessment

**Review Depth: Standard** - Low-risk story with simple redirect implementation. No auth/payment/security files touched, minimal code changes (<50 lines), clear acceptance criteria.

### Code Quality Assessment

**Overall: Excellent** ✓

The implementation is clean, minimal, and follows Next.js best practices. The developer made good architectural decisions:

1. **Defense-in-depth approach**: Using both `next.config.ts` redirects (primary) and `permanentRedirect()` in page.tsx (fallback) ensures robust redirect behavior.
2. **Proper 308 redirect**: Using permanent redirect is correct for SEO - search engines will treat `/products` as the canonical home page.
3. **Thorough link audit**: Developer proactively found and fixed `not-found.tsx` link during implementation.
4. **Clean component structure**: Logo.tsx and not-found.tsx properly updated with semantic color classes.

### Requirements Traceability

| AC  | Requirement                             | Implementation                                        | Status |
| --- | --------------------------------------- | ----------------------------------------------------- | ------ |
| AC1 | `/` redirects to `/products` (307/308)  | `next.config.ts` + `permanentRedirect()` in page.tsx  | ✓      |
| AC2 | Hero/banner content removed or archived | Hero content deleted from page.tsx                    | ✓      |
| AC3 | About/Contact accessible from header    | navLinks array contains `/about`, `/contact`          | ✓      |
| AC4 | SEO metadata updated                    | 308 permanent redirect; `/products` becomes canonical | ✓      |
| AC5 | Internal links pointing to `/` updated  | Logo.tsx, not-found.tsx updated                       | ⚠️     |

### Issue Found

**MEDIUM: Missed internal link in `stripe-payment-success/page.tsx`**

- **File**: [stripe-payment-success/page.tsx:90](<app/(root)/order/[id]/stripe-payment-success/page.tsx#L90>)
- **Issue**: "Continue Shopping" button still links to `/` instead of `/products`
- **Impact**: User clicks "Continue Shopping" after payment → lands on redirect → taken to products (works but suboptimal UX with extra redirect hop)

### Refactoring Performed

None - this issue should be addressed by the developer to keep the File List accurate.

### Compliance Check

- Coding Standards: ✓ - Uses semantic colors, proper imports, Next.js patterns
- Project Structure: ✓ - Files in correct locations
- Testing Strategy: ✓ - Manual testing documented, all IVs verified
- All ACs Met: ⚠️ - AC5 partially met (one link missed)

### Improvements Checklist

- [ ] Update `app/(root)/order/[id]/stripe-payment-success/page.tsx` line 90: change `href="/"` to `href="/products"` (AC5)
- [ ] Add file to File List in story after fix

### Security Review

No security concerns. This story only affects navigation, no auth/data handling changes.

### Performance Considerations

No performance concerns. The 308 redirect is cached by browsers, and the fallback `permanentRedirect()` adds negligible overhead.

### Files Modified During Review

None - leaving fix for developer to maintain accurate File List tracking.

### Gate Status

Gate: **CONCERNS** → docs/qa/gates/1.2-home-page-redirect.yml

One medium-severity issue (missed link) requires developer attention. Story is otherwise solid.

### Recommended Status

**✗ Changes Required** - Fix the one remaining link to `/` in stripe-payment-success/page.tsx before marking as Done.

---

### Re-Review Date: 2026-01-18

### Reviewed By: Quinn (Test Architect)

### Re-Review Summary

**Issue LINK-001 Resolved** ✓

Verified the fix in [stripe-payment-success/page.tsx:90](<app/(root)/order/[id]/stripe-payment-success/page.tsx#L90>):

- `href="/products"` now correctly set
- File List updated to include this file
- Change Log reflects the fix

### Updated Requirements Traceability

| AC  | Requirement                             | Status |
| --- | --------------------------------------- | ------ |
| AC1 | `/` redirects to `/products` (307/308)  | ✓      |
| AC2 | Hero/banner content removed or archived | ✓      |
| AC3 | About/Contact accessible from header    | ✓      |
| AC4 | SEO metadata updated                    | ✓      |
| AC5 | Internal links pointing to `/` updated  | ✓      |

### Updated Compliance Check

- Coding Standards: ✓
- Project Structure: ✓
- Testing Strategy: ✓
- All ACs Met: ✓

### Updated Gate Status

Gate: **PASS** → docs/qa/gates/1.2-home-page-redirect.yml

All acceptance criteria fully met. No outstanding issues.

### Recommended Status

**✓ Ready for Done** - All requirements satisfied, implementation is clean and complete.

---
